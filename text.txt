1. Missing `async/await`
   * `detectIntent`, `executeAction`, `saveBusinessData` need to be async
2. Wrong destructuring syntax - `const code, shop, state = req.query` should be `const { code, shop, state } = req.query`
3. detectIntent return format wrong - should return `{ intent, confidence }` not just `intent`
4. shopifyApiCall - function definition is malformed
5. buildSalesIQResponse - incomplete implementation
6. Missing await calls - many async functions called without await
7. ConversationMemory.addMessage - needs to accept `intent` parameter
8. getBusinessData - needs to load from file if not in memory
9. saveBusinessData - needs to persist to file
10. startServer function - missing initialization of persistence, these are the things need to fix in this whole code and other then that verify any logic error and flow error is there also fix that and give me the full corrected code and make sure the json files are creating with no error and save data and fetch data , make a full analyses like a compiler/tester and fix all the flaws and error then give me a full corrected codeIssues Found:
   1. Async/await missing in multiple places
   2. Destructuring syntax errors in OAuth callback
   3. detectIntent return format incorrect
   4. ConversationMemory class - missing proper context methods
   5. Business data loading - not integrated with persistence
   6. shopifyApiCall - proper implementation needed
   7. Missing imports and initialization
   8. Data persistence - not properly integrated
   9. Error handling - needs improvement
   10. Logic flow issues - memory not persisted, context not properly managed, due to cluade message limit give me this this part by part so that you dont get hit message limit